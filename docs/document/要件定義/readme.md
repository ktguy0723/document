# 要件定義
## 本記事のゴール
- 後工程で使える要件定義を作成するためのガイドライン

## 要件定義の概略
### 要件定義とは
> 発注側と受注側の間で合意した納品検収条件

### 要件定義の流れ
- 要望 → （要求 ⇔ 提案） → 要件
  - 要求・提案は発注側・受注側の間で何度も繰り返し詰めていく
  - 提案では可否判断するだけでなく、代替案を提案することが大切
- 要件定義で曖昧のまま進めると、発注側も受注側も不幸せになってしまう
> 要件定義とは「良い仕事を一緒にしていくための知恵」だといえるのです。

### 要件定義でのゴール
- プログラマ視点
> プログラマがソフトウェアを完成させるために必要な情報
> - UI
> - 機能
> - データ

- 発注側視点
> 完成したと納得できるもの
> - UIを通じてソフトウェアを操作すること
> - 操作に対してきちんと機能が動作すること
> - 機能が必要とするデータがきちんとそろっていること

- 要件定義とは、「設計者と発注者のかけ橋となる作業」
- これなら自分でも作れると確信を持てる要件定義をすることが大切
- そのためには、設計者と十分に検討する必要がある（もちろん発注者とも検討しよう！）

## 要件定義
- 【企画】企画書のサマリー
- 【企画】全体像（オーバービュー）
- 【企画】実装技術
- 【企画】実現したいこと一覧（要求一覧）
- 行動シナリオ一覧
- 【準備】行動シナリオ
- ワークセット一覧
- 【準備】概念データモデル
- 【要定】UI ラフイメージまたはモックアップ
- 【要定】UI 画面遷移図
- 【要定】UI 項目の説明
- 【要定】機能 機能の入出力定義
- 【要定】機能 機能の処理定義
- 【要定】データ 統合ER図  
最終的な成果物。この順で説明すると「全体→詳細」、「Why→What→How」と理解していくことができる構成になる。

### 【企画】企画書(のサマリー)
- Why: ゴールの定義を明確にし、作業関係者が共通認識を持てるようにするため
- What: 関係者各位が一目で理解を共有できる企画書
- 最低限必要な情報は下記
> 1. プロジェクトの名称
> 2. Why
>    - 目的（作ったことで得られる全体の効果/Effect）
> 3. What
>    - 目標達成のために作るもの（成果/Output）
>    - 作るものの説明（成果の説明）
>    - 作るものを利用する人（ステークホルダー）
>    - 利用する人が得られる利便（ユーザー個別の効果/Effect）
> 4. How
>    - 作るための体制
>    - 期限

### 【企画】全体像（オーバービュー）
- Why: ゴールの定義（スコープ）を明確にするため。機能の抜けもれをなくすため
- What: 企画の中で、「What」の部分をビジュアルに表現したもの
> 1. 作成するソフトウェアを描く
> 2. 利用者（システム管理者含み）を配置
> 3. 利用者が行うことを書く
> 3. 関連するシステムと連携内容（データ名称）を書く

**サブブロック図**
- ソフトウェアが大規模な場合に作成
- 全体像は外部連携、サブブロック図は内部連携
- 作成するソフトウェアの四角の内部に記載（参照）する。

### 【企画】実装技術
- Why: 要件定義はプログラミングに必要な情報を定めるために行うので、その前に技術方針を定める必要がある
- What: 基本的なシステムアーキテクチャと個別の実装技術
- 操作端末、言語、通信プロトコル、DB、フレームワークなど

### 【企画】要求一覧
- Why: ゴールの明確化
- What: 企画レベルから具体的な要求に落とし込む
> 1. やりたいことを洗い出す（可視化）
> 2. やりたいことを一覧にする（分析・整理）

- この作業を後工程にひきずると、スコープ爆発を引き起こす可能性が高くなる

### 【準備】行動シナリオ
- Why: 必要とされているソフトウェアがどういうものなのか確認できるようにするため
- What: ソフトウェアが完成したら利用者がどんな風に行動するかを書く。（利用タイミング、理由、利用者の仕事）
- 行動シナリオの登場人物
  - システムの利用者（ステークホルダー）
  - 今回作成するソフトウェア
- 誰が何をするためにソフトウェアを必要とするのかが明確になるように行動シナリオを記載する
  - ステークホルダーとソフトウェアの関連を明確にする
- UIの出現場所が大切
  - UIの出現場所 = 要件定義するシステムの出現箇所
- 要求一覧を用いてシナリオを練りこむ

### 【準備】概念データモデル
- Why: 要件定義をする際にスムーズに定義を進めるため
- What: データモデルの概要を作成する
- 行動シナリオをもとに、名詞・動詞を抽出する
- 後で詳細に行うのでこのタイミングではメモ書き、参考程度でよい

### 【要件定義】UI（ラフイメージ、画面遷移図、項目説明）
- What: UIの以下の基本要素を定義
  - データ項目
  - 操作項目
  - レイアウト

> 1. 行動シナリオの中に現れた対象となるUIをピックアップ  
> ワークセット = 一つの仕事をするソフトウェアの単位   
> 2. ピックアップしたワークセットの概要を確認  
> 「何をどうする」の形で記述 例：荷物の搬送指示をする
> 3. ラフなイメージを記載
> 4. ラフイメージから項目を拾い出して列挙  
> 画面名、データ項目（表示項目、入力項目）、操作項目
> 5. 動線（遷移）を整理
> 6. 動線の間に、イベントトリガーとそのあとの処理を明記
> 7. 詳細を詰める（今までの工程で発生した矛盾をなくす）
>     - 項目のエイリアス、シノニム、ホモニムを避ける（重複や別名を避ける）
>     - 導出項目（別の項目をもとに導出される項目）ももれなく定義する
>     - 定義漏れをなくさないようにすべての項目において説明できる状態にする (What is this? This is ...)
>     - エラーメッセージを定義する。現象、原因、対処方法がわかるようなメッセージにする
> 8. 必要に応じてビジュアルデザイン（配置、色など）を詳細に詰める

### 【要件定義】機能（入出力、処理定義）
- What: UIの工程で作成したものをベースに機能を定義
> 1. ワークセットごとの画面遷移図の機能をピックアップ
> 2. 機能の出力を決める
> 3. 出力を定めるための材料としての入力を決める
> 4. 入れ子（箇条書き）で処理を考える
>     - DBが必要ならここで画面遷移図に記載する
>     - 出力を提供するために行うことを決めるのがポイント
>     - レビューのためにも自然言語に近い形で記載する
> 5. ネストが深い機能を分割する

### 【要件定義】データ（統合ER図）
> 1. 項目を書きだす 
> 2. 正規化
> 3. リレーションシップの設定
> 4. EDRの結合

### 仕上げ
- エンティティ/ワークセットのCRUD図を作成
  - CRUDライフサイクルで漏れがある場合、ワークセットと行動シナリオを追加
- 非機能要件(応答性、可用性)を定義
- ロール/項目　のパーミッション表（権限表）を作成
- 行動シナリオ一覧、ワークセット一覧を作る
- 内部レビューを行う（疑問点をつぶす）

### TODO: 図の追加
```plantuml
行動シナリオ <= 概念データモデル: 参考
```
